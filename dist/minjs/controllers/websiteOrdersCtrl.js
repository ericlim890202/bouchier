!function(){"use strict";function e(e,r,t,o,n,a,s,i,d){var u=e;a.getList().then(function(e){u.websiteOrders=e,angular.forEach(u.websiteOrders,function(e){void 0!=e.orderNumber&&""!=e.orderNumber||(e.hide,a.post(e))}),u.searchForOrder=function(e){var r=[];return angular.forEach(u.websiteOrders,function(t){t.orderNumber==e.orderNumber&&(u.searchList="",r.push(t),u.websiteOrders=r)}),u.websiteOrders},u.refreshList=function(){a.getList().then(function(e){u.websiteOrders=e})},u.pageSize=10,u.currentPage=1,u.deleteModal=d({scope:u,templateUrl:"apps/admin/modals/webOrderDeleteModal.html",show:!1,animation:"am-fade-and-slide-top",placement:"center-top"}),u.showDeleteModal=function(e){u.modalItem=e,u.deleteModal.$promise.then(u.deleteModal.show)},u.deleteWebOrderItem=function(e){u.websiteOrders.remove(e).then(function(){a.getList().then(function(e){u.websiteOrders=e,u.deleteModal.hide()})})}}),e.uploadFiles=function(r,t){u.f=r,u.errFile=t&&t[0],r&&(r.upload=n.upload({url:"/uploads",data:{file:r}}),r.upload.then(function(r){i(function(){e.import("assets/images/xmas.min/"+r.data.url)})}))},e.import=function(r){s.get(r).success(function(r,t,o,n){var r=e.parsecsv(r);angular.forEach(r,function(e,r){if(r>0)var t={orderNumber:e[0],orderRef:e[1],dateCreated:e[2],firstName:e[3],lastName:e[4],email:e[5],title:e[25],quantity:e[27],variations:e[29],store:e[30],pickUpDate:e[31]};a.post(t)}),a.getList().then(function(e){u.websiteOrders=e,angular.forEach(u.websiteOrders,function(e){e.hide=!1,void 0==e.orderNumber||""==e.orderNumber?e.hide=!0:e.hide=!1,a.post(e)})})}).error(function(e,r,t,o){console.log("error",e)})},e.parsecsv=function(e){for(var r=new RegExp('(\\,|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\,\\r\\n]*))',"gi"),t=[[]],o=null;o=r.exec(e);){var n=o[1];n.length&&","!==n&&t.push([]);var a;a=o[2]?o[2].replace(new RegExp('""',"g"),'"'):o[3],t[t.length-1].push(a)}return t}}angular.module("app").controller("websiteOrdersCtrl",e),e.$inject=["$scope","Products","$state","$stateParams","Upload","WebsiteOrders","$http","$timeout","$modal"]}();